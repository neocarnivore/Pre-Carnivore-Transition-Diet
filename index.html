<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover">
  <title>Transition Diet, Crafted by Neo</title>
  <meta name="theme-color" content="#0b0b0f">
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="apple-touch-icon" href="icon-192.png">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<header>
  <div>Transition Diet, Crafted by Neo</div>
  <button id="themeToggle" style="width:auto;padding:8px 12px;background:transparent;border:1px solid var(--border);color:var(--text)">🌙/☀︎</button>
</header>

<div class="wrap">
  <!-- 入力 -->
  <div class="card">
    <div class="formGrid">
      <div class="pair">
        <div>
          <label for="sex">性別</label>
          <select id="sex">
            <option value="" selected disabled>選択してください</option>
            <option value="M">男性</option>
            <option value="F">女性</option>
          </select>
        </div>
        <div>
          <label for="age">年齢（歳）</label>
          <input id="age" type="number" inputmode="decimal" step="0.1" placeholder="例：30" min="12" max="99">
        </div>
      </div>

      <div class="pair">
        <div>
          <label for="height">身長（cm）</label>
          <input id="height" type="number" inputmode="decimal" step="0.1" placeholder="例：170" min="120" max="220">
        </div>
        <div>
          <label for="weight">体重（kg）</label>
          <input id="weight" type="number" inputmode="decimal" step="0.1" placeholder="例：65" min="30" max="250">
        </div>
      </div>

      <div class="pair" style="grid-column:1/-1">
        <div>
          <label for="rice">1日にお米を食べる量</label>
          <select id="rice">
            <option value="" selected disabled>選択してください</option>
            <option value="0.5">茶碗0〜1杯</option>
            <option value="2.5">茶碗2〜3杯</option>
            <option value="4.5">茶碗4〜5杯</option>
            <option value="6">茶碗6杯以上</option>
          </select>
        </div>
        <div>
          <label for="bread">1日にパンを食べる量</label>
          <select id="bread">
            <option value="" selected disabled>選択してください</option>
            <option value="0.5">0〜1枚（個）</option>
            <option value="2.5">2〜3枚（個）</option>
            <option value="4.5">4〜5枚（個）</option>
            <option value="6">6枚（個）以上</option>
          </select>
        </div>
      </div>

      <div class="pair" style="grid-column:1/-1">
        <div>
          <label for="rootveg">1日に根菜を食べる量</label>
          <select id="rootveg">
            <option value="" selected disabled>選択してください</option>
            <option value="0.5">拳0〜1個分</option>
            <option value="2.5">拳2〜3個分</option>
            <option value="4.5">拳4〜5個分</option>
            <option value="6">拳6個分以上</option>
          </select>
        </div>
        <div>
          <label for="habit">運動習慣</label>
          <select id="habit">
            <option value="" selected disabled>選択してください</option>
            <option value="1.2">ほぼ運動しない</option>
            <option value="1.375">週1〜2日</option>
            <option value="1.55">週3〜4日</option>
            <option value="1.725">週5〜6日</option>
            <option value="1.9">毎日/肉体労働</option>
          </select>
        </div>
      </div>

      <div class="pair">
        <div>
          <label for="fitnessType">フィットネス</label>
          <select id="fitnessType" disabled>
            <option value="" selected disabled>選択してください</option>
            <option value="none">該当なし</option>
            <option value="strength">筋トレ</option>
            <option value="run">ランニング</option>
            <option value="cycle">サイクリング</option>
            <option value="club">部活動</option>
            <option value="martial">格闘技</option>
            <option value="aerobic">その他（有酸素運動）</option>
            <option value="anaerobic">その他（無酸素運動）</option>
          </select>
        </div>
        <div>
          <label for="onoff">オン/オフ</label>
          <select id="onoff" disabled>
            <option value="" selected disabled>選択してください</option>
            <option value="none">該当なし</option>
            <option value="on">運動日</option>
            <option value="off">休息日</option>
          </select>
        </div>
      </div>
    </div>

    <div style="margin-top:12px">
      <button id="calcBtn" aria-pressed="false">計算</button>
    </div>
  </div>

  <!-- 基礎データ -->
  <div class="card" id="baseCard" style="display:none" aria-live="polite">
    <h3>基礎データ</h3>
    <div class="row3">
      <div class="kpi"><div class="small">BMI</div><b id="bmi">–</b></div>
      <div class="kpi"><div class="small">BMR（基礎代謝 kcal）</div><b id="bmr">–</b></div>
      <div class="kpi"><div class="small">TDEE（総消費 kcal）</div><b id="tdee">–</b></div>
    </div>
    <div class="small" id="bmiClassTxt" style="margin-top:8px;opacity:.9"></div>
  </div>

  <!-- あなたの目安 -->
  <div class="card" id="macroCard" style="display:none" aria-live="polite">
    <h3>あなたの目安（<span id="dietLabel">TRANSITION DIET</span>）</h3>
    <div class="kpi" style="margin-bottom:10px">
      <span class="small">摂取カロリー</span>
      <b class="big" id="kcal">–</b><span class="small">kcal/日</span>
    </div>
    <div class="row3">
      <div class="kpi macroBox"><div class="label">タンパク質</div><div class="val" id="p">–</div><div class="small">g/日</div><div class="kcal"><b id="pkcal">–</b><span class="small">kcal</span></div><div class="bar p"><span id="pbar"></span></div></div>
      <div class="kpi macroBox"><div class="label">脂質</div><div class="val" id="f">–</div><div class="small">g/日</div><div class="kcal"><b id="fkcal">–</b><span class="small">kcal</span></div><div class="bar f"><span id="fbar"></span></div></div>
      <div class="kpi macroBox"><div class="label">糖質</div><div class="val" id="c">–</div><div class="small">g/日</div><div class="kcal"><b id="ckcal">–</b><span class="small">kcal</span></div><div class="bar c"><span id="cbar"></span></div></div>
    </div>
    <div class="small" id="macroNote" style="margin-top:6px;opacity:.95">
      フィットネス：—｜ オン/オフ：— ｜ 糖質摂取量（目安）：— ｜ 活動係数AF×日別補正＝TDEE｜日別補正±12%内
    </div>
    <div class="small" id="elecLine" style="margin-top:4px;opacity:.95"></div>
    <div class="warn" id="fatWarn" style="display:none"></div>

    <details id="fixer" class="small" style="margin-top:10px">
      <summary>予定通りに摂れなかった？（修正案を作成・任意）</summary>
      <div class="fixgrid">
        <input id="actK" type="number" inputmode="decimal" placeholder="実績kcal">
        <input id="actP" type="number" inputmode="decimal" placeholder="実績P(g)">
        <input id="actF" type="number" inputmode="decimal" placeholder="実績F(g)">
        <input id="actC" type="number" inputmode="decimal" placeholder="実績C(g)">
      </div>
      <button id="fixBtn" style="width:auto;padding:8px 12px">修正案を作成</button>
      <div id="fixSuggest" class="small" style="margin-top:8px;opacity:.98"></div>
    </details>
  </div>

  <!-- 食材/グラフタブ -->
  <div class="card" id="mixCard" style="display:none" aria-live="polite">
    <div class="tab duo" role="tablist" aria-label="食材/体重タブ">
      <button id="tab-food" class="active" data-target="foodSection">食材別の目安摂取量</button>
      <button id="tab-chart" data-target="chartSection">糖質推移</button>
    </div>

    <section id="foodSection" class="section" style="display:block">
      <h3>食材別の目安摂取量</h3>
      <div class="row6">
        <div class="kpi"><span class="small">肉</span><b id="gMeat">–</b><span class="small">g</span><div class="small">≈ <b id="kMeat">–</b> kcal</div><div class="bar p"><span id="meatbar"></span></div></div>
        <div class="kpi"><span class="small">魚介類</span><b id="gFish">–</b><span class="small">g</span><div class="small">≈ <b id="kFish">–</b> kcal</div><div class="bar p"><span id="fishbar"></span></div></div>
        <div class="kpi"><span class="small">卵</span><b id="gEggs">–</b><span class="small">g</span><div class="small">≈ <b id="kEggs">–</b> kcal</div><div class="bar f"><span id="eggsbar"></span></div></div>
        <div class="kpi"><span class="small">乳製品</span><b id="gDairy">–</b><span class="small">g</span><div class="small">≈ <b id="kDairy">–</b> kcal</div><div class="bar f"><span id="dairybar"></span></div></div>
        <div class="kpi"><span class="small">野菜・穀物</span><b id="gVegGrain">–</b><span class="small">g</span><div class="small">≈ <b id="kVegGrain">–</b> kcal</div><div class="bar c"><span id="veggrainbar"></span></div></div>
        <div class="kpi"><span class="small">果物</span><b id="gFruit">–</b><span class="small">g</span><div class="small">≈ <b id="kFruit">–</b> kcal</div><div class="bar c"><span id="fruitbar"></span></div></div>
      </div>
      <div class="small" id="kcal100Note" style="margin-top:8px;opacity:.95">
        ※100gあたり代表値（目安）：肉 280kcal / 魚介類 150kcal / 卵 150kcal / 乳製品 160kcal / 野菜・穀物 —kcal / 果物 60kcal
      </div>
    </section>

    <section id="chartSection" class="section" style="display:none">
      <h3>糖質摂取量推移</h3>
      <div class="chartPickers">
        <div>
          <label>n週間目</label>
          <div class="tab weeks" id="chartWeekTabs" role="tablist" aria-label="週" style="display:none"></div>
        </div>
        <div>
          <label>n日目</label>
          <div class="tab days" id="chartDayTabs" role="tablist" aria-label="日数" style="display:none"></div>
        </div>
      </div>
      <div class="kpi chartCard" style="border:none;background:transparent;box-shadow:none">
        <div class="chartHeader">
          <div class="small" id="chartTitle" style="font-weight:700">4週間で移行する場合</div>
        </div>
        <canvas id="wtChart" height="260" aria-label="糖質摂取量推移グラフ" role="img"></canvas>
      </div>
    </section>
  </div>

  <p class="small footerNote" style="margin-top:20px">
    ※各プランはカーニボア食・ケトジェニック食を支持する医師・医学博士らの文献・著書・研究のもと設計しています。<br>
    参考: Virta Health（<a href="https://www.youtube.com/@VirtaHealth" target="_blank" rel="noopener">YouTube</a>） / The Noakes Foundation（<a href="https://www.youtube.com/@TheNoakesFoundation" target="_blank" rel="noopener">YouTube</a>）
  </p>
</div>

<script type="module" src="app.js"></script>
</body>
</html>
